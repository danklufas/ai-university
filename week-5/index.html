
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../week-4/">
      
      
        <link rel="next" href="../cheat-sheet/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Week 5 - AI University Curriculum</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#week-5-lesson-plan-ethics-bias-responsible-ai" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AI University Curriculum" class="md-header__button md-logo" aria-label="AI University Curriculum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI University Curriculum
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Week 5
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AI University Curriculum" class="md-nav__button md-logo" aria-label="AI University Curriculum" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AI University Curriculum
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roadmap
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Weeks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Weeks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../week-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Week 4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Week 5
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Week 5
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-lesson-overview" class="md-nav__link">
    <span class="md-ellipsis">
      1. Lesson Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-core-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      2. Core Definitions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-concept-sections" class="md-nav__link">
    <span class="md-ellipsis">
      3. Concept Sections
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Concept Sections">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-where-bias-creeps-in-and-real-examples" class="md-nav__link">
    <span class="md-ellipsis">
      A. Where Bias Creeps In (and Real Examples)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-fairness-metrics-intuition-formula" class="md-nav__link">
    <span class="md-ellipsis">
      B. Fairness Metrics (Intuition → Formula)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-privacy-consent-and-regulation-high-level" class="md-nav__link">
    <span class="md-ellipsis">
      C. Privacy, Consent, and Regulation (High Level)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-responsible-ai-frameworks-governance" class="md-nav__link">
    <span class="md-ellipsis">
      D. Responsible AI Frameworks &amp; Governance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-tools-installation-setup-week-5-specific" class="md-nav__link">
    <span class="md-ellipsis">
      4. Tools Installation &amp; Setup (Week 5 Specific)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Tools Installation &amp; Setup (Week 5 Specific)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-install-fairness-explainability-packages" class="md-nav__link">
    <span class="md-ellipsis">
      A. Install Fairness &amp; Explainability Packages
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-step-by-step-exercises-10" class="md-nav__link">
    <span class="md-ellipsis">
      5. Step-by-Step Exercises (10)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Step-by-Step Exercises (10)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-1-quick-bias-scan-with-pandas" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: Quick Bias Scan with pandas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-equal-opportunity-from-confusion-matrices" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: Equal Opportunity from Confusion Matrices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-fairness-metrics-with-fairlearnmetricframe" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: Fairness Metrics with fairlearn.MetricFrame
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-4-threshold-adjustment-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 4: Threshold Adjustment Mitigation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-5-shap-for-feature-influence-proxy-detection" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 5: SHAP for Feature Influence (Proxy Detection)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-6-red-team-prompting-for-llm-safety" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 6: Red-Team Prompting for LLM Safety
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-7-mini-model-card" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 7: Mini Model Card
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-8-privacy-policy-mapping-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 8: Privacy &amp; Policy Mapping Checklist
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-9-reweighting-mitigation-with-fairlearn-reductions" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 9: Reweighting Mitigation with Fairlearn Reductions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-10-build-a-responsible-ai-checklist-for-your-company" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 10: Build a Responsible AI Checklist for Your Company
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-summary-of-week-5" class="md-nav__link">
    <span class="md-ellipsis">
      6. Summary of Week 5
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-additional-resources" class="md-nav__link">
    <span class="md-ellipsis">
      7. Additional Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cheat-sheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cheat Sheet
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="week-5-lesson-plan-ethics-bias-responsible-ai">Week 5 Lesson Plan – Ethics, Bias &amp; Responsible AI</h1>
<hr />
<h2 id="1-lesson-overview">1. Lesson Overview</h2>
<p><strong>Learning Objectives</strong></p>
<p>By the end of this week you will be able to:</p>
<ul>
<li>Identify common <strong>sources of bias</strong> in data, labeling, and algorithms.  </li>
<li>Calculate and interpret key <strong>fairness metrics</strong> (e.g., demographic parity, equal opportunity).  </li>
<li>Understand core <strong>privacy &amp; compliance concepts</strong> (consent, minimization, GDPR/PIPEDA basics).  </li>
<li>Apply <strong>responsible AI frameworks</strong> (checklists, governance processes) to your own projects.  </li>
<li>Use Python tools to <strong>measure and mitigate bias</strong> in a toy dataset.</li>
</ul>
<hr />
<h2 id="2-core-definitions">2. Core Definitions</h2>
<table>
<thead>
<tr>
<th>Term</th>
<th>Definition</th>
<th>Simple Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Algorithmic Bias</strong></td>
<td>Systematic and repeatable errors that create unfair outcomes.</td>
<td>Loan model approves 80% of group A but 55% of group B.</td>
</tr>
<tr>
<td><strong>Demographic Parity</strong></td>
<td>Selection/positive rate should be similar across groups.</td>
<td>% approved loans for men ≈ % for women.</td>
</tr>
<tr>
<td><strong>Equal Opportunity</strong></td>
<td>True positive rate should be equal across groups.</td>
<td>Cancer detection model should catch positives equally well for all races.</td>
</tr>
<tr>
<td><strong>Fairness Metric</strong></td>
<td>Quantitative measure of disparity (e.g., difference in TPR).</td>
<td>TPR_A − TPR_B ≤ 0.05 target.</td>
</tr>
<tr>
<td><strong>Data Minimization</strong></td>
<td>Collect only what is necessary for the task.</td>
<td>Don’t store SSNs if you only need age.</td>
</tr>
<tr>
<td><strong>Explainability</strong></td>
<td>Ability to interpret model decisions.</td>
<td>SHAP values showing which features drove a prediction.</td>
</tr>
<tr>
<td><strong>Responsible AI Governance</strong></td>
<td>Policies, processes, and tools ensuring ethical deployment.</td>
<td>Review board, model cards, audit logs.</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3-concept-sections">3. Concept Sections</h2>
<h3 id="a-where-bias-creeps-in-and-real-examples">A. Where Bias Creeps In (and Real Examples)</h3>
<ol>
<li>
<p><strong>Data Collection Bias</strong> – Your dataset under-represents a subgroup.<br />
<em>Example:</em> Feedback forms mostly from tech-savvy users → product skews to their needs.</p>
</li>
<li>
<p><strong>Labeling Bias</strong> – Human annotators carry their own prejudices.<br />
<em>Example:</em> Historical hiring decisions labeled “good candidate” reflect past discrimination.</p>
</li>
<li>
<p><strong>Measurement / Proxy Bias</strong> – Using a proxy variable that encodes sensitive info.<br />
<em>Example:</em> Zip code as proxy for race or income.</p>
</li>
<li>
<p><strong>Algorithm/Optimization Bias</strong> – Loss functions ignore fairness constraints.<br />
<em>Example:</em> Optimizing only for accuracy favors majority class.</p>
</li>
<li>
<p><strong>Deployment &amp; Feedback Loops</strong> – Model outputs change behavior, which changes inputs.<br />
<em>Example:</em> Police patrol more in predicted “hot spots” → more arrests → model “proves” itself.</p>
</li>
</ol>
<p><strong>Why This Matters:</strong> You can’t fix what you can’t see. Knowing the phases of an ML pipeline helps you inject checks at the right places.</p>
<hr />
<h3 id="b-fairness-metrics-intuition-formula">B. Fairness Metrics (Intuition → Formula)</h3>
<p><strong>1. Demographic Parity (DP):</strong><br />
Positive prediction rate should be equal.<br />
[
\text{DP\ diff} = |P(\hat{Y}=1 \mid A=0) - P(\hat{Y}=1 \mid A=1)|
]</p>
<p><strong>2. Equal Opportunity (EOpp):</strong><br />
True positive rates equal across groups.<br />
[
\text{EOpp\ diff} = |TPR_{A=0} - TPR_{A=1}|
]</p>
<p><strong>3. Equalized Odds:</strong><br />
Both TPR and FPR equal across groups.</p>
<p><strong>4. Predictive Parity / Calibration:</strong><br />
Given a score, actual outcome probability is the same for each group.</p>
<p><strong>Trade-offs:</strong><br />
You usually can’t satisfy all metrics simultaneously; pick what matches the product’s ethical goals and legal context.</p>
<hr />
<h3 id="c-privacy-consent-and-regulation-high-level">C. Privacy, Consent, and Regulation (High Level)</h3>
<ul>
<li><strong>Privacy Principles:</strong> consent, purpose limitation, data minimization, security, accountability.  </li>
<li><strong>De-identification &amp; Anonymization:</strong> remove direct identifiers; but beware re-identification via linkage.  </li>
<li><strong>Basic Regs to Know (Canada/EU/US):</strong>  </li>
<li>PIPEDA (Canada) – personal info rules for private sector.  </li>
<li>GDPR (EU) – rights to access, erase, data portability.  </li>
<li>Sector-specific (HIPAA, COPPA, etc.) if you handle health/children’s data.</li>
</ul>
<p><strong>Focus for You:</strong> Build habits—log data sources, justify fields collected, document retention &amp; deletion plans.</p>
<hr />
<h3 id="d-responsible-ai-frameworks-governance">D. Responsible AI Frameworks &amp; Governance</h3>
<ul>
<li><strong>Checklists &amp; Model Cards:</strong> Document purpose, data, limitations, bias tests, maintenance plan.  </li>
<li><strong>NIST AI RMF / OECD Principles:</strong> Risk management, transparency, accountability.  </li>
<li><strong>Human-in-the-loop:</strong> Allow overrides, appeals, escalation paths.  </li>
<li><strong>Monitoring in Prod:</strong> Drift detection, fairness checks on new data, incident response.</li>
</ul>
<p><strong>Why This Matters:</strong> Stakeholders (investors, customers, regulators) increasingly demand proof you’re managing AI responsibly.</p>
<hr />
<h2 id="4-tools-installation-setup-week-5-specific">4. Tools Installation &amp; Setup (Week 5 Specific)</h2>
<blockquote>
<p>You already have NumPy, pandas, matplotlib. This week we’ll add a fairness library and a quick explainability tool.</p>
</blockquote>
<h3 id="a-install-fairness-explainability-packages">A. Install Fairness &amp; Explainability Packages</h3>
<p><strong>Fairlearn (fairness metrics &amp; mitigation) + SHAP (explainability):</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># conda (recommended)</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>fairlearn<span class="w"> </span>shap<span class="w"> </span>-y
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># or pip</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>pip<span class="w"> </span>install<span class="w"> </span>fairlearn<span class="w"> </span>shap
</code></pre></div>
<h2 id="5-step-by-step-exercises-10">5. Step-by-Step Exercises (10)</h2>
<hr />
<h3 id="exercise-1-quick-bias-scan-with-pandas">Exercise 1: Quick Bias Scan with <code>pandas</code></h3>
<p><strong>Overview &amp; Purpose</strong><br />
Check basic demographic parity by grouping outcomes by a sensitive attribute.</p>
<p><strong>Concept Reinforcement</strong><br />
- Demographic parity (selection rate)<br />
- <code>groupby</code> aggregation in pandas</p>
<p><strong>Real‑World Relevance</strong><br />
- Loan approvals by gender/race<br />
- Hiring pass rates across departments</p>
<p><strong>Step-by-Step Instructions</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="s2">&quot;score&quot;</span><span class="p">:</span>    <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="s2">&quot;approved&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>    <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">1</span>   <span class="p">],</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="s2">&quot;gender&quot;</span><span class="p">:</span>   <span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span><span class="p">,</span>  <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">,</span> <span class="s2">&quot;M&quot;</span> <span class="p">]</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="p">}</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="n">rates</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;gender&quot;</span><span class="p">)[</span><span class="s2">&quot;approved&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">rates</span><span class="p">)</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="n">dp_diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">rates</span><span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">rates</span><span class="p">[</span><span class="s2">&quot;F&quot;</span><span class="p">])</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Demographic parity diff:&quot;</span><span class="p">,</span> <span class="n">dp_diff</span><span class="p">)</span>
</code></pre></div>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- Two approval rates (e.g., M ~0.80, F ~0.50).<br />
- <code>dp_diff</code> shows the absolute disparity (e.g., 0.30).</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Add more groups (age buckets, regions).<br />
- Plot a bar chart of approval rates.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Ensure your sensitive attribute names are consistent (<code>"gender"</code>, <code>"race"</code>, etc.).<br />
- Use <code>.value_counts(normalize=True)</code> to get proportions quickly.</p>
<hr />
<h3 id="exercise-2-equal-opportunity-from-confusion-matrices">Exercise 2: Equal Opportunity from Confusion Matrices</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Manually compute TPR (true positive rate) by group and compare.</p>
<p><strong>Concept Reinforcement</strong><br />
- Equal opportunity metric<br />
- Confusion matrix interpretation</p>
<p><strong>Real‑World Relevance</strong><br />
- Medical diagnosis rates across demographics<br />
- Fraud detection recall differences</p>
<p><strong>Step-by-Step Instructions</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1"># Confusion matrices: rows = actual (0/1), cols = predicted (0/1)</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># group A (e.g., M)</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">cm_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>                 <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">35</span><span class="p">]])</span>  <span class="c1"># TN, FP / FN, TP</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># group B (e.g., F)</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">cm_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">48</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>                 <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">28</span><span class="p">]])</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="n">TPR_A</span> <span class="o">=</span> <span class="n">cm_A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cm_A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">cm_A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="n">TPR_B</span> <span class="o">=</span> <span class="n">cm_B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cm_B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">cm_B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TPR_A:&quot;</span><span class="p">,</span> <span class="n">TPR_A</span><span class="p">,</span> <span class="s2">&quot;TPR_B:&quot;</span><span class="p">,</span> <span class="n">TPR_B</span><span class="p">,</span> <span class="s2">&quot;Diff:&quot;</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">TPR_A</span> <span class="o">-</span> <span class="n">TPR_B</span><span class="p">))</span>
</code></pre></div>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- You’ll see each group’s TPR and the disparity (diff).<br />
- Large diffs (&gt;0.05) could flag fairness concerns.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Add FPR comparison for Equalized Odds.<br />
- Visualize with a grouped bar chart.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Double-check TN/FP/FN/TP ordering—easy to mix up!</p>
<hr />
<h3 id="exercise-3-fairness-metrics-with-fairlearnmetricframe">Exercise 3: Fairness Metrics with <code>fairlearn.MetricFrame</code></h3>
<p><strong>Overview &amp; Purpose</strong><br />
Use Fairlearn to compute multiple metrics per group in one shot.</p>
<p><strong>Concept Reinforcement</strong><br />
- MetricFrame abstraction<br />
- Selection rate, TPR, FPR</p>
<p><strong>Real‑World Relevance</strong><br />
- Faster audits in production pipelines<br />
- Compliance reporting dashboards</p>
<p><strong>Step-by-Step Instructions</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fairlearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetricFrame</span><span class="p">,</span> <span class="n">selection_rate</span><span class="p">,</span> <span class="n">true_positive_rate</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">y_true</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">y_pred</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">gender</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">,</span><span class="s2">&quot;M&quot;</span><span class="p">]</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">mf</span> <span class="o">=</span> <span class="n">MetricFrame</span><span class="p">(</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="n">metrics</span><span class="o">=</span><span class="p">{</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>        <span class="s2">&quot;selection_rate&quot;</span><span class="p">:</span> <span class="n">selection_rate</span><span class="p">,</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        <span class="s2">&quot;tpr&quot;</span><span class="p">:</span> <span class="n">true_positive_rate</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="p">},</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="n">y_true</span><span class="o">=</span><span class="n">y_true</span><span class="p">,</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>    <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="n">sensitive_features</span><span class="o">=</span><span class="n">gender</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="p">)</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="nb">print</span><span class="p">(</span><span class="n">mf</span><span class="o">.</span><span class="n">by_group</span><span class="p">)</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TPR diff:&quot;</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;between_groups&#39;</span><span class="p">)[</span><span class="s2">&quot;tpr&quot;</span><span class="p">])</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Selection rate diff:&quot;</span><span class="p">,</span> <span class="n">mf</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;between_groups&#39;</span><span class="p">)[</span><span class="s2">&quot;selection_rate&quot;</span><span class="p">])</span>
</code></pre></div>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- Table of metrics per group.<br />
- Differences help identify unfairness.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Add more metrics: <code>false_positive_rate</code>, <code>accuracy</code>.<br />
- Try <code>mf.group_min()</code> / <code>group_max()</code> to see bounds.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Fairlearn can also handle continuous scores (probabilities).</p>
<hr />
<h3 id="exercise-4-threshold-adjustment-mitigation">Exercise 4: Threshold Adjustment Mitigation</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Show how different decision thresholds per group can reduce disparity.</p>
<p><strong>Concept Reinforcement</strong><br />
- Post-processing mitigation<br />
- Trade-off between fairness and overall accuracy</p>
<p><strong>Real‑World Relevance</strong><br />
- Lending thresholds per applicant segment<br />
- Medical triage thresholds by demographic</p>
<p><strong>Step-by-Step Instructions</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fairlearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetricFrame</span><span class="p">,</span> <span class="n">selection_rate</span><span class="p">,</span> <span class="n">true_positive_rate</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c1"># Synthetic data with slight bias</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;M&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">0.7</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span><span class="o">==</span><span class="s2">&quot;M&quot;</span><span class="p">)</span><span class="o">*</span><span class="mf">0.2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span><span class="o">*</span><span class="mf">0.1</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">A_train</span><span class="p">,</span> <span class="n">A_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="p">)</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="n">probs</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="c1"># Single threshold (baseline)</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="n">y_pred_base</span> <span class="o">=</span> <span class="p">(</span><span class="n">probs</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="c1"># Group-specific thresholds (try to equalize selection rate)</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="n">thr_M</span><span class="p">,</span> <span class="n">thr_F</span> <span class="o">=</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.45</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="n">y_pred_adj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">A_test</span><span class="o">==</span><span class="s2">&quot;M&quot;</span><span class="p">,</span> <span class="n">probs</span><span class="o">&gt;</span><span class="n">thr_M</span><span class="p">,</span> <span class="n">probs</span><span class="o">&gt;</span><span class="n">thr_F</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="c1"># Compare</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;selection_rate&quot;</span><span class="p">:</span> <span class="n">selection_rate</span><span class="p">,</span> <span class="s2">&quot;tpr&quot;</span><span class="p">:</span> <span class="n">true_positive_rate</span><span class="p">}</span>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="n">mf_base</span> <span class="o">=</span> <span class="n">MetricFrame</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_base</span><span class="p">,</span> <span class="n">sensitive_features</span><span class="o">=</span><span class="n">A_test</span><span class="p">)</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a><span class="n">mf_adj</span>  <span class="o">=</span> <span class="n">MetricFrame</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_adj</span><span class="p">,</span>  <span class="n">sensitive_features</span><span class="o">=</span><span class="n">A_test</span><span class="p">)</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;BASELINE</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mf_base</span><span class="o">.</span><span class="n">by_group</span><span class="p">)</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ADJUSTED</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">mf_adj</span><span class="o">.</span><span class="n">by_group</span><span class="p">)</span>
</code></pre></div>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- Adjusted thresholds should narrow metric gaps but may lower overall accuracy.<br />
- Discuss trade-offs.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Use Fairlearn’s <code>ThresholdOptimizer</code> to find thresholds automatically.<br />
- Try optimizing for EO instead of DP.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Document any manual thresholding in model cards.</p>
<hr />
<h3 id="exercise-5-shap-for-feature-influence-proxy-detection">Exercise 5: SHAP for Feature Influence (Proxy Detection)</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Use SHAP to see if a seemingly innocuous feature proxies a sensitive attribute.</p>
<p><strong>Concept Reinforcement</strong><br />
- Explainability for fairness<br />
- Feature attribution</p>
<p><strong>Real‑World Relevance</strong><br />
- Spotting “zip code → race” proxies in credit scoring<br />
- Detecting age proxies in hiring models</p>
<p><strong>Step-by-Step Instructions</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">shap</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">shap</span><span class="o">.</span><span class="n">initjs</span><span class="p">()</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">explainer</span> <span class="o">=</span> <span class="n">shap</span><span class="o">.</span><span class="n">LinearExplainer</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_train</span><span class="p">)</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">shap_values</span> <span class="o">=</span> <span class="n">explainer</span><span class="o">.</span><span class="n">shap_values</span><span class="p">(</span><span class="n">X_test</span><span class="p">[:</span><span class="mi">50</span><span class="p">])</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># Summary plot (opens in Jupyter notebook)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">shap</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">shap_values</span><span class="p">,</span> <span class="n">X_test</span><span class="p">[:</span><span class="mi">50</span><span class="p">],</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f1&quot;</span><span class="p">,</span><span class="s2">&quot;f2&quot;</span><span class="p">,</span><span class="s2">&quot;f3&quot;</span><span class="p">])</span>
</code></pre></div>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- See which features drive predictions.<br />
- Compare distribution of feature values by group.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Try <code>shap.dependence_plot</code> for single features.<br />
- Use <code>TreeExplainer</code> for tree models.</p>
<p><strong>Notes &amp; Tips</strong><br />
- SHAP can be slow on big models; sample data.</p>
<hr />
<h3 id="exercise-6-red-team-prompting-for-llm-safety">Exercise 6: Red-Team Prompting for LLM Safety</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Stress-test a chatbot or LLM prompt to find unethical/unsafe outputs.</p>
<p><strong>Concept Reinforcement</strong><br />
- Safety testing / adversarial prompting<br />
- Policy compliance</p>
<p><strong>Real‑World Relevance</strong><br />
- Ensure customer support bots don’t give legal/medical advice without disclaimers<br />
- Prevent harmful outputs (hate speech, PII leaks)</p>
<p><strong>Step-by-Step Instructions</strong><br />
1. Write 5–10 “tricky” prompts (e.g., “How can I evade taxes?”).<br />
2. Record model responses.<br />
3. Label each as <strong>Acceptable / Needs Warning / Reject</strong>.<br />
4. Propose guardrails (prompt constraints, filters).<br />
5. (Optional) Implement regex/keyword filters or model moderation endpoints.</p>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- A list of failure modes and mitigations.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Use OpenAI moderation API or similar tools.<br />
- Create a “prompt safety checklist.”</p>
<p><strong>Notes &amp; Tips</strong><br />
- Keep logs; iterate regularly as prompts evolve.</p>
<hr />
<h3 id="exercise-7-mini-model-card">Exercise 7: Mini Model Card</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Create a concise “model card” for one of your previous models (e.g., Week 4 MLP).</p>
<p><strong>Concept Reinforcement</strong><br />
- Documentation &amp; transparency<br />
- Stakeholder communication</p>
<p><strong>Real‑World Relevance</strong><br />
- Internal/external audits<br />
- Customer trust</p>
<p><strong>Step-by-Step Instructions</strong><br />
1. Template sections:<br />
   - <strong>Model Details:</strong> type, version, date.<br />
   - <strong>Intended Use / Out-of-Scope Use.</strong><br />
   - <strong>Data:</strong> source, preprocessing, known issues.<br />
   - <strong>Metrics:</strong> overall + by subgroup (if available).<br />
   - <strong>Ethical Considerations &amp; Limitations.</strong><br />
   - <strong>Maintenance / Update Plan.</strong><br />
2. Write 1–2 pages in Markdown (<code>model-card.md</code>).<br />
3. Store in repo for traceability.</p>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- Clear, repeatable doc for future models.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Use Google’s Model Card toolkit format.<br />
- Add visual metric tables.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Update the card when the model changes.</p>
<hr />
<h3 id="exercise-8-privacy-policy-mapping-checklist">Exercise 8: Privacy &amp; Policy Mapping Checklist</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Map a SaaS feature’s data flow to privacy and fairness controls.</p>
<p><strong>Concept Reinforcement</strong><br />
- Data minimization<br />
- Governance alignment</p>
<p><strong>Real‑World Relevance</strong><br />
- PIPEDA/GDPR readiness<br />
- Due diligence for M&amp;A</p>
<p><strong>Step-by-Step Instructions</strong><br />
1. List all personal data fields you collect.<br />
2. For each: purpose, retention time, who can access.<br />
3. Identify fairness checks pre/post deployment.<br />
4. Note missing policies/processes.<br />
5. Summarize in a checklist doc (<code>privacy-fairness-checklist.md</code>).</p>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- Gap analysis for compliance.<br />
- Action plan items.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Map to NIST AI RMF categories.<br />
- Add incident response flowchart.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Revisit quarterly; regulations change.</p>
<hr />
<h3 id="exercise-9-reweighting-mitigation-with-fairlearn-reductions">Exercise 9: Reweighting Mitigation with Fairlearn Reductions</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Apply algorithmic mitigation (reweighting) using Fairlearn’s reductions API.</p>
<p><strong>Concept Reinforcement</strong><br />
- Pre-/in-processing mitigation<br />
- Constraint-based optimization</p>
<p><strong>Real‑World Relevance</strong><br />
- Achieving fairness goals without fully redesigning model<br />
- Regulatory evidence</p>
<p><strong>Step-by-Step Instructions</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">fairlearn.reductions</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExponentiatedGradient</span><span class="p">,</span> <span class="n">DemographicParity</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">estimator</span>   <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">constraint</span>  <span class="o">=</span> <span class="n">DemographicParity</span><span class="p">()</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">mitigator</span>   <span class="o">=</span> <span class="n">ExponentiatedGradient</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">estimator</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraint</span><span class="p">)</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="n">mitigator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">sensitive_features</span><span class="o">=</span><span class="n">A_train</span><span class="p">)</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="n">y_pred_mitigated</span> <span class="o">=</span> <span class="n">mitigator</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</code></pre></div>
<p>Compute fairness/accuracy metrics before vs. after (reuse MetricFrame).</p>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- Reduced DP diff, possibly lower accuracy.<br />
- Discuss acceptable trade-offs.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Try <code>EqualizedOdds()</code> constraint.<br />
- Compare different base estimators.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Reductions can be slow; start with small datasets.</p>
<hr />
<h3 id="exercise-10-build-a-responsible-ai-checklist-for-your-company">Exercise 10: Build a Responsible AI Checklist for Your Company</h3>
<p><strong>Overview &amp; Purpose</strong><br />
Translate week’s concepts into an actionable internal policy.</p>
<p><strong>Concept Reinforcement</strong><br />
- Governance operationalization<br />
- Continuous monitoring</p>
<p><strong>Real‑World Relevance</strong><br />
- CRO Software &amp; Micro Manage Software policies<br />
- Investor/board confidence</p>
<p><strong>Step-by-Step Instructions</strong><br />
1. Sections to include:<br />
   - <strong>Data Intake Questions</strong> (Why do we need this? How long keep it?)<br />
   - <strong>Bias &amp; Fairness Checks</strong> (Which metrics? How often?)<br />
   - <strong>Privacy Compliance Steps</strong> (Consent, retention, deletion).<br />
   - <strong>Human Review &amp; Overrides</strong> (Escalation path).<br />
   - <strong>Monitoring &amp; Incident Response</strong> (Who watches? What triggers alerts?).<br />
2. Draft in Markdown (<code>responsible-ai-checklist.md</code>).<br />
3. Review quarterly.</p>
<p><strong>Expected Outcomes &amp; Interpretation</strong><br />
- A living document guiding responsible AI work.</p>
<p><strong>Extensions &amp; Variations</strong><br />
- Add sign-off lines for teams (Data, Legal, Exec).<br />
- Link to model cards &amp; audit logs.</p>
<p><strong>Notes &amp; Tips</strong><br />
- Keep it practical—short enough people actually use it.</p>
<hr />
<h2 id="6-summary-of-week-5">6. Summary of Week 5</h2>
<p>This week you:</p>
<ul>
<li><strong>Mapped the sources of bias</strong> (data, labels, algorithms, feedback loops) and learned where to intervene.  </li>
<li><strong>Quantified fairness</strong> using demographic parity, equal opportunity, and equalized odds—understanding trade-offs.  </li>
<li><strong>Practiced mitigation</strong> techniques: threshold adjustment, reweighting via Fairlearn, and transparency through SHAP.  </li>
<li><strong>Integrated privacy principles</strong> (consent, minimization, retention) and learned the basics of major regulations (GDPR, PIPEDA).  </li>
<li><strong>Created governance artifacts</strong>: model cards, checklists, red-team prompts—turning ethics into repeatable processes.</li>
</ul>
<p>You now have a repeatable workflow to ask: <em>Is it fair? Is it explainable? Is it compliant?</em>—before shipping models.</p>
<hr />
<h2 id="7-additional-resources">7. Additional Resources</h2>
<ul>
<li><strong>Fairlearn Documentation:</strong> <a href="https://fairlearn.org">https://fairlearn.org</a>  </li>
<li><strong>SHAP Documentation:</strong> <a href="https://shap.readthedocs.io">https://shap.readthedocs.io</a>  </li>
<li><strong>“Model Cards for Model Reporting”</strong> – Google AI (Mitchell et al.)  </li>
<li><strong>NIST AI Risk Management Framework (AI RMF)</strong>  </li>
<li><strong>OECD AI Principles</strong>  </li>
<li><strong>The Ethical Algorithm</strong> (Michael Kearns &amp; Aaron Roth)  </li>
<li><strong>Partnership on AI Resources:</strong> <a href="https://partnershiponai.org">https://partnershiponai.org</a>  </li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.indexes", "content.code.copy", "navigation.instant", "navigation.top", "toc.integrate"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>